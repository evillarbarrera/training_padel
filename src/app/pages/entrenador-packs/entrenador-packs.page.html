<ion-content>

  <!-- Hero Header -->
  <div class="header-nike">
    <div class="header-overlay"></div>
    <div class="header-content">
      <h1 class="header-title">Mis Packs</h1>
      <p class="header-sub">Gestiona tu oferta acadÃ©mica</p>
    </div>
  </div>

  <!-- Main Content -->
  <div class="dashboard-container">

    <!-- Actions & Filter -->
    <div class="actions-wrapper animate-up">
      <ion-button expand="block" class="nike-button main-btn" (click)="abrirModal()">
        <ion-icon name="plus-outline" slot="start"></ion-icon>
        Nuevo Pack
      </ion-button>

      <div class="nike-search-box">
        <ion-icon name="search-outline"></ion-icon>
        <ion-input placeholder="Buscar por nombre..." [(ngModel)]="filtro" (ionInput)="filtrarPacks()">
        </ion-input>
      </div>
    </div>

    <!-- Packs List -->
    <div class="packs-list">

      <div class="nike-card horizontal-pack-card coach-pack animate-up"
        *ngFor="let pack of packsFiltrados; let i = index" [style.animation-delay]="(i * 0.05) + 's'">
        <div class="card-media">
          <img src="assets/mod-packs.jpg" class="pack-img">
        </div>

        <div class="card-content-main">
          <div class="pack-header">
            <h3>{{ pack.nombre }}</h3>
            <span class="price-tag">${{ pack.precio }}</span>
          </div>

          <div class="pack-details-row">
            <span>{{ pack.sesiones_totales }} clases</span>
            <span class="dot">â€¢</span>
            <span>{{ pack.duracion_sesion_min }} min</span>
            <span class="dot">â€¢</span>
            <span class="type-tag">{{ pack.tipo }}</span>
            <!-- Info grupal si aplica -->
            <ng-container *ngIf="pack.tipo === 'grupal'">
              <span class="dot">â€¢</span>
              <span class="cupos-badge" [ngClass]="pack.estado_grupo">
                <ng-container *ngIf="pack.estado_grupo === 'activo'">ðŸŸ¢ {{ pack.cupos_ocupados }}/{{ pack.capacidad_maxima }}</ng-container>
                <ng-container *ngIf="pack.estado_grupo === 'pendiente'">ðŸŸ¡ {{ pack.cupos_ocupados }}/{{ pack.capacidad_minima }}</ng-container>
              </span>
            </ng-container>
          </div>

          <div class="pack-footer">
            <div class="footer-actions">
              <ion-button fill="clear" color="primary" class="btn-icon" (click)="editarPack(pack)">
                <ion-icon name="create-outline"></ion-icon>
              </ion-button>
              <ion-button fill="clear" color="danger" class="btn-icon" (click)="eliminarPack(pack.id)">
                <ion-icon name="trash-outline"></ion-icon>
              </ion-button>
            </div>
          </div>
        </div>
      </div>

    </div>

  </div>

  <!-- Back FAB -->
  <ion-fab vertical="bottom" horizontal="start" slot="fixed">
    <ion-fab-button class="nike-fab back-fab" (click)="goBack()">
      <ion-icon name="chevron-back-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>

<!-- Modal Premium -->
<ion-modal [isOpen]="modalOpen" (didDismiss)="cerrarModal()" class="nike-modal">
  <ng-template>
    <ion-header mode="ios" class="ion-no-border">
      <ion-toolbar>
        <ion-title>{{ nuevoPack.id ? 'Editar Pack' : 'Nuevo Pack' }}</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="cerrarModal()">
            <ion-icon name="close-outline"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content>
      <div class="modal-form">
        <div class="input-group">
          <div class="nike-field">
            <label>Nombre del Pack</label>
            <ion-item lines="none" class="nike-item">
              <ion-input [(ngModel)]="nuevoPack.nombre" placeholder="Ej: Pack Pro 10"></ion-input>
            </ion-item>
          </div>

          <div class="nike-field">
            <label>Tipo de SesiÃ³n</label>
            <ion-item lines="none" class="nike-item">
              <ion-select [(ngModel)]="nuevoPack.tipo" interface="popover">
                <ion-select-option value="individual">Individual</ion-select-option>
                <ion-select-option value="grupal">Grupal</ion-select-option>
              </ion-select>
            </ion-item>
          </div>

          <!-- Campos para packs grupales -->
          <ng-container *ngIf="nuevoPack.tipo === 'grupal'">
            <div class="form-grid">
              <div class="nike-field">
                <label>Capacidad MÃ­nima</label>
                <ion-item lines="none" class="nike-item">
                  <ion-input type="number" [(ngModel)]="nuevoPack.capacidad_minima" min="2" max="6"></ion-input>
                </ion-item>
              </div>
              <div class="nike-field">
                <label>Capacidad MÃ¡xima</label>
                <ion-item lines="none" class="nike-item">
                  <ion-input type="number" [(ngModel)]="nuevoPack.capacidad_maxima" min="2" max="6"></ion-input>
                </ion-item>
              </div>
            </div>

            <div class="form-grid">
              <div class="nike-field">
                <label>DÃ­a de la Semana</label>
                <ion-item lines="none" class="nike-item">
                  <ion-select [(ngModel)]="nuevoPack.dia_semana" interface="popover">
                    <ion-select-option value="0">Domingo</ion-select-option>
                    <ion-select-option value="1">Lunes</ion-select-option>
                    <ion-select-option value="2">Martes</ion-select-option>
                    <ion-select-option value="3">MiÃ©rcoles</ion-select-option>
                    <ion-select-option value="4">Jueves</ion-select-option>
                    <ion-select-option value="5">Viernes</ion-select-option>
                    <ion-select-option value="6">SÃ¡bado</ion-select-option>
                  </ion-select>
                </ion-item>
              </div>
              <div class="nike-field">
                <label>Hora de Inicio</label>
                <ion-item lines="none" class="nike-item">
                  <ion-input type="time" [(ngModel)]="nuevoPack.hora_inicio"></ion-input>
                </ion-item>
              </div>
            </div>

            <div class="nike-field">
              <label>CategorÃ­a</label>
              <ion-item lines="none" class="nike-item">
                <ion-input [(ngModel)]="nuevoPack.categoria" placeholder="Ej: Principiantes, Intermedios, Avanzados"></ion-input>
              </ion-item>
            </div>
          </ng-container>

          <div class="form-grid">
            <div class="nike-field">
              <label>NÂº Clases</label>
              <ion-item lines="none" class="nike-item">
                <ion-input type="number" [(ngModel)]="nuevoPack.sesiones_totales"></ion-input>
              </ion-item>
            </div>
            <div class="nike-field">
              <label>Minutos</label>
              <ion-item lines="none" class="nike-item">
                <ion-input type="number" [(ngModel)]="nuevoPack.duracion_sesion_min"></ion-input>
              </ion-item>
            </div>
          </div>

          <div class="nike-field">
            <label>Precio ($)</label>
            <ion-item lines="none" class="nike-item">
              <ion-input type="number" [(ngModel)]="nuevoPack.precio"></ion-input>
            </ion-item>
          </div>

          <div class="nike-field">
            <label>DescripciÃ³n</label>
            <ion-item lines="none" class="nike-item textarea">
              <ion-textarea [(ngModel)]="nuevoPack.descripcion" placeholder="Detalles del pack..."></ion-textarea>
            </ion-item>
          </div>
        </div>

        <ion-button expand="block" class="nike-button main-btn save-btn" (click)="crearPack()">
          Confirmar y Guardar
        </ion-button>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>